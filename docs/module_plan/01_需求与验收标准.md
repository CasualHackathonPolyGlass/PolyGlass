# 需求与验收标准（评审对齐）

**版本**：v0.1 (MVP)
**时间**：2026-01

---

## 1. 必须满足（全部）

| 要求 | 说明 | 验收方式 |
|------|------|----------|
| **数据来源** | Polygon 链 Polymarket 真实数据（RPC 获取） | 检查 RPC 调用日志 |
| **数据验证** | 展示链上获取并解码的真实数据 ≥100 条 | Dashboard 页面验证 |
| **可运行** | 评审环境能运行并产出结果 | 一条命令启动 |
| **文档完整** | README + 架构说明 | 检查文档目录 |

---

## 2. 技术基线（至少 2 项，MVP 目标 4-5 项）

| 基线项 | 状态 | 说明 |
|--------|------|------|
| ✅ 交易解码 | 必做 | 解析 OrderFilled（价格、方向、TokenId） |
| ✅ 市场识别 | 必做 | TokenId → Market |
| ✅ 数据存储 | 必做 | SQLite 持久化 |
| ✅ API 接口 | 必做 | 至少 1 个 HTTP 端点（建议 4 个） |
| ✅ 前端展示 | 必做 | Web Dashboard |

---

## 3. 验收 Checklist

### 3.1 Dashboard 页面

- [ ] `/dashboard` 页面能看到 trades 表格
- [ ] 表格显示至少 100 条交易
- [ ] 每条 trade 有 txHash，可复制到浏览器验证
- [ ] 每条 trade 显示 tokenId、direction、price、market title

### 3.2 数据库

- [ ] SQLite 数据库文件存在
- [ ] `markets` 表有数据
- [ ] `trades` 表行数 ≥ 100

### 3.3 API

- [ ] `GET /api/trades?limit=100` 返回有效 JSON
- [ ] 返回数据包含必要字段
- [ ] 返回条数为 100（或实际不足时返回全部）

---

## 4. 字段验收标准

### Trade 必须字段

```typescript
interface TradeForValidation {
  // 链上原始字段
  txHash: string;         // 0x 开头，66 字符
  blockNumber: number;    // > 0
  logIndex: number;       // >= 0

  // 解码字段
  maker: string;          // 0x 开头，42 字符
  taker: string;          // 0x 开头，42 字符
  tokenId: string;        // 非空

  // 派生字段
  direction: 'BUY' | 'SELL';
  price: number;          // 0 <= price <= 1
  marketId: string;       // 非空（允许少量 unknown）
  marketTitle: string;    // 非空
}
```

---

## 5. 验收流程

```
1. 克隆仓库
   git clone <repo>
   cd polymarket-dashboard

2. 安装依赖
   pnpm install

3. 一键启动（或分步）
   pnpm start:demo
   # 或
   pnpm db:migrate && pnpm fetch && pnpm dev

4. 验证
   - 打开 http://localhost:3000/dashboard
   - 确认 trades 表格有 ≥100 条
   - 点击任意 txHash 复制到 Polygonscan 验证
   - curl http://localhost:3000/api/trades?limit=100

5. 检查数据库
   sqlite3 ./data/app.db "SELECT COUNT(*) FROM trades;"
```
